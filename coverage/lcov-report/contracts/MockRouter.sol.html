<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for contracts\MockRouter.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">contracts/</a> MockRouter.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">43.24% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>16/37</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">23.08% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>6/26</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">53.85% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>7/13</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">48% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>24/50</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">46×</span>
<span class="cline-any cline-yes">46×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">46×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;
&nbsp;
/**
 * @title MockRouter
 * @dev Contrato mock para simular o router do PancakeSwap nos testes
 */
contract MockRouter {
    // Eventos para simular comportamento real
    event Swap(address indexed tokenIn, address indexed tokenOut, uint256 amountIn, uint256 amountOut);
    event LiquidityAdded(address indexed token, uint256 amountToken, uint256 amountETH);
    
    // Mapeamento para simular preços
    mapping(address =&gt; uint256) public tokenPrices;
    
    // Configurações
    uint256 public constant MOCK_LIQUIDITY = 1000;
    uint256 public constant MOCK_SLIPPAGE = 50; // 0.5%
    
    constructor() {
        // Configura preços padrão para tokens conhecidos
        tokenPrices[address(0x1111111111111111111111111111111111111111)] = 1e18; // 1 USD
        tokenPrices[address(0x2222222222222222222222222222222222222222)] = 300e18; // 300 USD (BNB)
    }
&nbsp;
    function factory() external pure returns (address) {
        return address(0x1111111111111111111111111111111111111111);
    }
&nbsp;
    function WETH() external pure returns (address) {
        return address(0x2222222222222222222222222222222222222222);
    }
    
<span class="fstat-no" title="function not covered" >    function addLiquidityETH(</span>
        address token,
        uint amountTokenDesired,
        uint _amountTokenMin,
        uint _amountETHMin,
        address _to,
        uint deadline
    ) external payable returns (uint amountToken, uint amountETH, uint liquidity) {
<span class="cstat-no" title="statement not covered" >        require(msg.value &gt; 0, "Must send ETH")</span>;
<span class="cstat-no" title="statement not covered" >        require(amountTokenDesired &gt; 0, "Must send tokens")</span>;
<span class="cstat-no" title="statement not covered" >        require(deadline &gt;= block.timestamp, "Deadline passed")</span>;
        
        // Simula adição de liquidez
        amountToken = amountTokenDesired;
        amountETH = msg.value;
        liquidity = MOCK_LIQUIDITY;
        
<span class="cstat-no" title="statement not covered" >        emit LiquidityAdded(token, amountToken, amountETH);</span>
        
<span class="cstat-no" title="statement not covered" >        return (amountToken, amountETH, liquidity);</span>
    }
    
<span class="fstat-no" title="function not covered" >    function swapExactTokensForETHSupportingFeeOnTransferTokens(</span>
        uint amountIn,
        uint amountOutMin,
        address[] calldata path,
        address to,
        uint deadline
    ) external {
<span class="cstat-no" title="statement not covered" >        require(path.length &gt;= 2, "Invalid path")</span>;
<span class="cstat-no" title="statement not covered" >        require(deadline &gt;= block.timestamp, "Deadline passed")</span>;
<span class="cstat-no" title="statement not covered" >        require(to != address(0), "Invalid recipient")</span>;
        
        // Simula swap
<span class="cstat-no" title="statement not covered" >        uint256 amountOut = _calculateSwapOutput(amountIn, path);</span>
<span class="cstat-no" title="statement not covered" >        require(amountOut &gt;= amountOutMin, "Insufficient output amount")</span>;
        
<span class="cstat-no" title="statement not covered" >        emit Swap(path[0], path[1], amountIn, amountOut);</span>
    }
    
    function getAmountsOut(uint amountIn, address[] calldata path) external view returns (uint[] memory amounts) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(path.length &gt;= 2, "Invalid path");
        
        amounts = new uint[](path.length);
        amounts[0] = amountIn;
        
        for (uint i = 1; i &lt; path.length; i++) {
            amounts[i] = _calculateSwapOutput(amounts[i-1], path[i-1], path[i]);
        }
        
        return amounts;
    }
    
    function getAmountsIn(uint amountOut, address[] calldata path) external view returns (uint[] memory amounts) {
        <span class="missing-if-branch" title="else path not taken" >E</span>require(path.length &gt;= 2, "Invalid path");
        
        amounts = new uint[](path.length);
        amounts[path.length - 1] = amountOut;
        
        for (uint i = path.length - 1; i &gt; 0; i--) {
            amounts[i-1] = _calculateSwapInput(amounts[i], path[i-1], path[i]);
        }
        
        return amounts;
    }
    
    // Funções auxiliares para simular preços
<span class="fstat-no" title="function not covered" >    function setTokenPrice(address token, uint256 price) external {</span>
        tokenPrices[token] = price;
    }
    
<span class="fstat-no" title="function not covered" >    function getTokenPrice(address token) external view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        return tokenPrices[token];</span>
    }
    
    // Funções internas para cálculos
<span class="fstat-no" title="function not covered" >    function _calculateSwapOutput(uint256 amountIn, address[] memory path) internal view returns (uint256) {</span>
<span class="cstat-no" title="statement not covered" >        uint256 currentAmount = amountIn;</span>
<span class="cstat-no" title="statement not covered" >        for (uint i = 0; i &lt; path.length - 1; i++) {</span>
            currentAmount = _calculateSwapOutput(currentAmount, path[i], path[i+1]);
        }
<span class="cstat-no" title="statement not covered" >        return currentAmount;</span>
    }
    
    function _calculateSwapOutput(uint256 amountIn, address tokenIn, address tokenOut) internal view returns (uint256) {
        uint256 priceIn = tokenPrices[tokenIn];
        uint256 priceOut = tokenPrices[tokenOut];
        
        <span class="missing-if-branch" title="else path not taken" >E</span>if (priceIn == 0 || <span class="branch-1 cbranch-no" title="branch not covered" >priceOut == 0</span>) {
            return amountIn; // 1:1 se preço não definido
        }
        
        // Simula conversão de preço com slippage
<span class="cstat-no" title="statement not covered" >        uint256 amountOut = (amountIn * priceIn) / priceOut;</span>
<span class="cstat-no" title="statement not covered" >        uint256 slippage = (amountOut * MOCK_SLIPPAGE) / 10000;</span>
<span class="cstat-no" title="statement not covered" >        return amountOut - slippage;</span>
    }
    
    function _calculateSwapInput(uint256 amountOut, address tokenIn, address tokenOut) internal view returns (uint256) {
        uint256 priceIn = tokenPrices[tokenIn];
        uint256 priceOut = tokenPrices[tokenOut];
        
        <span class="missing-if-branch" title="else path not taken" >E</span>if (priceIn == 0 || <span class="branch-1 cbranch-no" title="branch not covered" >priceOut == 0</span>) {
            return amountOut; // 1:1 se preço não definido
        }
        
        // Simula conversão reversa de preço com slippage
<span class="cstat-no" title="statement not covered" >        uint256 amountIn = (amountOut * priceOut) / priceIn;</span>
<span class="cstat-no" title="statement not covered" >        uint256 slippage = (amountIn * MOCK_SLIPPAGE) / 10000;</span>
<span class="cstat-no" title="statement not covered" >        return amountIn + slippage;</span>
    }
    
    // Função para receber ETH
    receive() external payable {}
    
    // Função de emergência para recuperar tokens
<span class="fstat-no" title="function not covered" >    function recoverTokens(address token, uint256 amount) external {</span>
        // Mock implementation - não faz nada
    }
} </pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu Jun 26 2025 19:13:28 GMT-0300 (Horário Padrão de Brasília)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
